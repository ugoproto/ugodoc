
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Data Science documentation website.">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Codecademy, SQL, Table Transformation - ugodoc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="red">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#subqueries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ugodoc" class="md-header__button md-logo" aria-label="ugodoc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ugodoc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Codecademy, SQL, Table Transformation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ugoproto/ugodoc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugodoc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ugodoc" class="md-nav__button md-logo" aria-label="ugodoc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    ugodoc
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ugoproto/ugodoc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugodoc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Vade Mecum
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Vade Mecum" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Vade Mecum
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../charts/" class="md-nav__link">
        Charts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../digital_humanities/" class="md-nav__link">
        Digital Humanities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edition_cs/" class="md-nav__link">
        Edition Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infographies/" class="md-nav__link">
        Infographies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../latex_snippets/" class="md-nav__link">
        LaTeX Snippets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resources_for_data_science/" class="md-nav__link">
        Resources for Data Science
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storytelling_with_data/" class="md-nav__link">
        Storytelling with Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ten_stories_data/" class="md-nav__link">
        Ten Kinds of Stories to Tell with Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dix_recits_donnees/" class="md-nav__link">
        Dix trames de récits avec des données
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visual_perception/" class="md-nav__link">
        Visual Perception (visualisation)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          OS & CLI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OS & CLI" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          OS & CLI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../os_cs/" class="md-nav__link">
        OS Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codecademy_learn_the_command_line_notes/" class="md-nav__link">
        Codecademy, Learn the Command Line Notes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../command_line_crash_course/" class="md-nav__link">
        Command Line Crash Course
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../command_shell_snippets/" class="md-nav__link">
        Command Shell Snippets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli_regex_git/" class="md-nav__link">
        CLI, regex, and Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../the_linux_command_line/" class="md-nav__link">
        The Linux Command Line
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usefull_shell_commands_for_data_science/" class="md-nav__link">
        Useful Shell Commands for Data Science
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          SQL & NoSQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL & NoSQL" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          SQL & NoSQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sql_nosql_cs/" class="md-nav__link">
        SQL-NoSQL Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codecademy_learn_sql/" class="md-nav__link">
        Codecademy, Learn SQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codecademy_sql_analyzing_business_metrics/" class="md-nav__link">
        Codecademy, SQL, Analyzing Business Metrics
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Codecademy, SQL, Table Transformation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Codecademy, SQL, Table Transformation
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#subqueries" class="md-nav__link">
    Subqueries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-correlated-subqueries" class="md-nav__link">
    Non-Correlated Subqueries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlated-subqueries" class="md-nav__link">
    Correlated Subqueries
  </a>
  
    <nav class="md-nav" aria-label="Correlated Subqueries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-tables-together" class="md-nav__link">
    Merging Tables Together
  </a>
  
    <nav class="md-nav" aria-label="Merging Tables Together">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    UNION
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersect" class="md-nav__link">
    INTERSECT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#except" class="md-nav__link">
    EXCEPT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_1" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditional-aggregates" class="md-nav__link">
    Conditional Aggregates
  </a>
  
    <nav class="md-nav" aria-label="Conditional Aggregates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_2" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#date-number-and-string-functions" class="md-nav__link">
    Date, Number, and String Functions
  </a>
  
    <nav class="md-nav" aria-label="Date, Number, and String Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_3" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction_to_sql_joins/" class="md-nav__link">
        Introduction to SQL JOINs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Web
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Web" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../embedding/" class="md-nav__link">
        Embedding HTML into HTML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../html_and_css/" class="md-nav__link">
        HTML and CSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../responsive_html/" class="md-nav__link">
        Responsive HTML
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#subqueries" class="md-nav__link">
    Subqueries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-correlated-subqueries" class="md-nav__link">
    Non-Correlated Subqueries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlated-subqueries" class="md-nav__link">
    Correlated Subqueries
  </a>
  
    <nav class="md-nav" aria-label="Correlated Subqueries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-tables-together" class="md-nav__link">
    Merging Tables Together
  </a>
  
    <nav class="md-nav" aria-label="Merging Tables Together">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    UNION
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersect" class="md-nav__link">
    INTERSECT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#except" class="md-nav__link">
    EXCEPT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_1" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditional-aggregates" class="md-nav__link">
    Conditional Aggregates
  </a>
  
    <nav class="md-nav" aria-label="Conditional Aggregates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_2" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#date-number-and-string-functions" class="md-nav__link">
    Date, Number, and String Functions
  </a>
  
    <nav class="md-nav" aria-label="Date, Number, and String Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-can-we-generalize-so-far_3" class="md-nav__link">
    What can we generalize so far?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugodoc.git/edit/master/docs/codecademy_sql_table_transformation.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Codecademy, SQL, Table Transformation</h1>
                
                <p><strong>Foreword</strong></p>
<p>Code snippets. From Codecademy.</p>
<hr />
<p>While working with databases, we often need to transform data from one format to achieve a desired result. In SQL, this is often called data transformation or table transformation.</p>
<h2 id="subqueries">Subqueries<a class="headerlink" href="#subqueries" title="Permanent link">&para;</a></h2>
<p>Subqueries, sometimes referred to as inner queries or nested queries, are used to transform table data by nesting one query within another query. </p>
<p>Two tables: <code>airports</code> and <code>flights</code>.</p>
<p>Select ten rows from the <code>flights</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
<span class="o">```</span><span class="k">sql</span>

<span class="n">We</span> <span class="k">first</span> <span class="k">create</span> <span class="n">an</span> <span class="k">inner</span> <span class="n">query</span><span class="p">,</span> <span class="k">or</span> <span class="n">subquery</span><span class="p">,</span> <span class="n">that</span> <span class="n">finds</span> <span class="n">the</span> <span class="n">airports</span> <span class="k">with</span> <span class="n">elevation</span> <span class="n">greater</span> <span class="k">than</span> <span class="mi">2000</span> <span class="k">from</span> <span class="n">the</span> <span class="o">`</span><span class="n">airports</span><span class="o">`</span> <span class="k">table</span><span class="p">.</span> 

<span class="o">```</span><span class="k">sql</span>
<span class="k">SELECT</span> <span class="n">code</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">WHERE</span> <span class="n">elevation</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">;</span>
</code></pre></div>
<p>Next, we take the result set of the inner query and use it to filter on the <code>flights</code> table, to find the flight detail that meets the elevation criteria.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">in</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">code</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">WHERE</span> <span class="n">elevation</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">);</span>
</code></pre></div>
<p>Find flight information about <code>flights</code> where the origin elevation is less than 2000 feet.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">in</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">code</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">WHERE</span> <span class="n">elevation</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">);</span>
</code></pre></div>
<h2 id="non-correlated-subqueries">Non-Correlated Subqueries<a class="headerlink" href="#non-correlated-subqueries" title="Permanent link">&para;</a></h2>
<p>A non-correlated subquery is a subquery that can be run independently of the outer query and as we saw, can be used to complete a multi-step transformation.</p>
<p>Perhaps we&rsquo;d like to look at a selection of <code>flights</code> whose origin airport is a seaplane base, designated by <code>'SEAPLANE_BASE'</code>. The facility type of an airport is located in the <code>fac_type</code> field of the <code>airports</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">in</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">code</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">WHERE</span> <span class="n">fac_type</span> <span class="o">=</span> <span class="s1">&#39;SEAPLANE_BASE&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Using the same pattern, find flight information about <code>flights</code> where the Federal Aviation Administration region (<code>faa_region</code>) is the Southern region (<code>'ASO'</code>).</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">in</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">code</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">WHERE</span> <span class="n">faa_region</span> <span class="o">=</span> <span class="s1">&#39;ASO&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Perform transformations on a single table. For instance, sometimes we need to aggregate in multiple steps &ndash; like taking an average of a count.</p>
<p>Imagine you’d like to know how many <code>flights</code> there are on average, for all Fridays in a given month from the <code>flights</code> table. First, we’d need to calculate the number of <code>flights</code> per day, and then we’d need to calculate the average based on the daily flight count for each day of the week. We can do this all in one step using a subquery:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="n">dep_month</span><span class="p">,</span>
       <span class="n">a</span><span class="p">.</span><span class="n">dep_day_of_week</span><span class="p">,</span>
       <span class="k">AVG</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">flight_count</span><span class="p">)</span> <span class="k">AS</span> <span class="n">average_</span><span class="o">`</span><span class="n">flights</span><span class="o">`</span>
    <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">dep_month</span><span class="p">,</span>
               <span class="n">dep_day_of_week</span><span class="p">,</span>
               <span class="n">dep_date</span><span class="p">,</span>
               <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">flight_count</span>
        <span class="k">FROM</span> <span class="o">`</span><span class="n">flights</span><span class="o">`</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
        <span class="p">)</span> <span class="n">a</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">;</span>
</code></pre></div>
<p>The inner query provides the count of flights by day, and the outer query uses the inner query’s result set to compute the average by day of week of a given month.</p>
<p>Using a subquery, find the average total distance flown by day of week and month. Be sure to alias the outer query as <code>average_distance</code> and the inner query as <code>flight_distance</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="n">dep_month</span><span class="p">,</span>
       <span class="n">a</span><span class="p">.</span><span class="n">dep_day_of_week</span><span class="p">,</span>
       <span class="k">AVG</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">flight_distance</span><span class="p">)</span> <span class="k">AS</span> <span class="n">average_distance</span>
    <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">dep_month</span><span class="p">,</span>
              <span class="n">dep_day_of_week</span><span class="p">,</span>
               <span class="n">dep_date</span><span class="p">,</span>
               <span class="k">sum</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="k">AS</span> <span class="n">flight_distance</span>
        <span class="k">FROM</span> <span class="o">`</span><span class="n">flights</span><span class="o">`</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
    <span class="p">)</span> <span class="n">a</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">;</span>
</code></pre></div>
<h2 id="correlated-subqueries">Correlated Subqueries<a class="headerlink" href="#correlated-subqueries" title="Permanent link">&para;</a></h2>
<p>In a correlated subquery, the subquery can not be run independently of the outer query. The order of operations is important in a correlated subquery:</p>
<p>A row is processed in the outer query. Then, for that particular row in the outer query, the subquery is executed.</p>
<p>This means that for each row processed by the outer query, the subquery will also be processed for that row. In this example, we will find the list of all flights whose distance is above average for their carrier (query on a query, same table).</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span>
<span class="k">FROM</span> <span class="o">`</span><span class="n">flights</span><span class="o">`</span> <span class="k">AS</span> <span class="n">f</span>
<span class="k">WHERE</span> <span class="n">distance</span> <span class="o">&gt;</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="o">`</span><span class="n">flights</span><span class="o">`</span>
    <span class="k">WHERE</span> <span class="n">carrier</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">carrier</span><span class="p">);</span>
</code></pre></div>
<p>In the above query the inner query has to be re-executed for each flight. Correlated subqueries may appear elsewhere besides the <code>WHERE</code> clause, they can also appear in the <code>SELECT</code>.</p>
<p>Find the id of the flights whose distance is below average for their carrier.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span>
<span class="k">FROM</span> <span class="n">flights</span> <span class="k">AS</span> <span class="n">f</span>
<span class="k">WHERE</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">flights</span>
    <span class="k">WHERE</span> <span class="n">carrier</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">carrier</span><span class="p">);</span>
</code></pre></div>
<p>It would also be interesting to order flights by giving them a sequence number based on time, by carrier. For instance, assuming flight_id increments with each additional flight, we could use the following query to view flights by carrier, flight id, and sequence number:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">carrier</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
        <span class="k">FROM</span> <span class="n">flights</span> <span class="n">f</span>
        <span class="k">WHERE</span> <span class="n">f</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="n">flights</span><span class="p">.</span><span class="n">id</span>
        <span class="k">AND</span> <span class="n">f</span><span class="p">.</span><span class="n">carrier</span><span class="o">=</span><span class="n">flights</span><span class="p">.</span><span class="n">carrier</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 
        <span class="k">AS</span> <span class="n">flight_sequence_number</span>
        <span class="k">FROM</span> <span class="n">flights</span><span class="p">;</span>
</code></pre></div>
<p>Using the same pattern, write a query to view flights by origin, flight id, and sequence number. Alias the sequence number column as <code>flight_sequence_number</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">origin</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">flights</span> <span class="n">f</span>
    <span class="k">WHERE</span> <span class="n">f</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="n">flights</span><span class="p">.</span><span class="n">id</span>
    <span class="k">AND</span> <span class="n">f</span><span class="p">.</span><span class="n">origin</span><span class="o">=</span><span class="n">flights</span><span class="p">.</span><span class="n">origin</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> 
    <span class="k">AS</span> <span class="n">flight_sequence_number</span>
    <span class="k">FROM</span> <span class="n">flights</span><span class="p">;</span>
</code></pre></div>
<h3 id="what-can-we-generalize-so-far">What can we generalize so far?<a class="headerlink" href="#what-can-we-generalize-so-far" title="Permanent link">&para;</a></h3>
<ul>
<li>Subqueries are used to complete an SQL transformation by nesting one query within another query.</li>
<li>A non-correlated subquery is a subquery that can be run independently of the outer query and can be used to complete a multi-step transformation.</li>
<li>A correlated subquery is a subquery that cannot be run independently of the outer query. The order of operations in a correlated subquery is as follows:<ol>
<li>A row is processed in the outer query.</li>
<li>Then, for that particular row in the outer query, the subquery is executed.</li>
<li>Set Operations.</li>
</ol>
</li>
</ul>
<p>Unions allow us to utilize information from multiple tables in our queries. In this lesson, we’ll utilize data from an e-commerce store. Let’s explore the available data we’ll be using. </p>
<p>Four tables: <code>new_products</code>, <code>legacy_products</code>, <code>order_items</code> and <code>order_items_historic</code>.</p>
<p>In our database, we have products tables that contain metadata about each product in the store. Select ten rows from the <code>new_products</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">new_products</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div>
<h2 id="merging-tables-together">Merging Tables Together<a class="headerlink" href="#merging-tables-together" title="Permanent link">&para;</a></h2>
<p>Sometimes, in order to answer certain questions based on data, we need to merge two tables together and then query the merged result. Perhaps we have two tables that contain information about products in an ecommerce store that we would like to combine. There are two ways of doing this:</p>
<ul>
<li>Merge the rows, called a <code>JOIN</code>.</li>
<li>Merge the columns, called a <code>UNION</code>.</li>
</ul>
<h3 id="union"><code>UNION</code><a class="headerlink" href="#union" title="Permanent link">&para;</a></h3>
<p>We&rsquo;ll focus on unions here. Union combines the result of two or more <code>SELECT</code> statements, using the following syntax:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table1</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table2</span><span class="p">;</span>
</code></pre></div>
<p>Each <code>SELECT</code> statement within the <code>UNION</code> must have the same number of columns with similar data types. The columns in each <code>SELECT</code> statement must be in the same order. By default, the <code>UNION</code> operator selects only distinct values.</p>
<p>Suppose we are a growing ecommerce store and recently acquired another store to diversify our offering. The product data still exists in two separate tables: a <code>legacy_products</code> table and a <code>new_products</code> table. To get the complete list of product names from both tables, we can perform the following union.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">item_name</span> <span class="k">FROM</span> <span class="n">legacy_products</span>
<span class="k">UNION</span> 
<span class="k">SELECT</span> <span class="n">item_name</span> <span class="k">FROM</span> <span class="n">new_products</span><span class="p">;</span>
</code></pre></div>
<p>Select a complete list of brand names from the <code>legacy_products</code> and <code>new_products</code> tables.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">brand</span> <span class="k">FROM</span> <span class="n">legacy_products</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">brand</span> <span class="k">FROM</span> <span class="n">new_products</span><span class="p">;</span>
</code></pre></div>
<p>What if we wanted to allow duplicate values? We can do this by using the <code>ALL</code> keyword with <code>UNION</code>, with the following syntax:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table1</span>
<span class="k">UNION</span> <span class="k">ALL</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table2</span><span class="p">;</span>
</code></pre></div>
<p>In our ecommerce store, if we learned that we had records from historic order items in an additional table, we could use the following query to combine the tables for a complete analysis of sale price:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items</span>
<span class="k">UNION</span> <span class="k">ALL</span>
<span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items_historic</span><span class="p">;</span>
</code></pre></div>
<p>Then we can perform an analysis on top of the combined result set, like finding the total count of order items.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items</span>
    <span class="k">UNION</span> <span class="k">ALL</span>
    <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items_historic</span><span class="p">)</span> <span class="k">as</span> <span class="n">a</span><span class="p">;</span>
</code></pre></div>
<p>Using the same pattern, utilize a subquery to find the average sale price over both <code>order_items</code> and <code>order_items_historic</code> tables.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">avg</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">sale_price</span><span class="p">)</span> <span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items</span>
    <span class="k">UNION</span> <span class="k">ALL</span>
    <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">sale_price</span> <span class="k">FROM</span> <span class="n">order_items_historic</span><span class="p">)</span> <span class="k">AS</span> <span class="n">a</span> 
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Before running the top analysis, create an alias a with the preliminary results, run the <code>avg(a.sale_price)</code>, and group by 1 to view separate records and not a unique aggregate record!!!</p>
<h3 id="intersect"><code>INTERSECT</code><a class="headerlink" href="#intersect" title="Permanent link">&para;</a></h3>
<p>&hellip;is used to combine two <code>SELECT</code> statements, but returns rows only from the first <code>SELECT</code> statement that are identical to a row in the second <code>SELECT</code> statement. This means that it returns only common rows returned by the two <code>SELECT</code> statements.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table1</span>
<span class="k">INTERSECT</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table2</span><span class="p">;</span>
</code></pre></div>
<p>For instance, we might want to know what brands in our newly acquired store are also in our legacy store. We can do so using the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">brand</span> <span class="k">FROM</span> <span class="n">new_products</span>
<span class="k">INTERSECT</span>
<span class="k">SELECT</span> <span class="n">brand</span> <span class="k">FROM</span> <span class="n">legacy_products</span><span class="p">;</span>
</code></pre></div>
<p>Select the items in the category column that are both in the newly acquired <code>new_products</code> table and the <code>legacy_products</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">new_products</span>
<span class="k">INTERSECT</span>
<span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">legacy_products</span><span class="p">;</span>
</code></pre></div>
<h3 id="except"><code>EXCEPT</code><a class="headerlink" href="#except" title="Permanent link">&para;</a></h3>
<p>&hellip;is constructed in the same way, but returns distinct rows from the first <code>SELECT</code> statement that aren’t output by the second <code>SELECT</code> statement.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table1</span>
<span class="k">EXCEPT</span>
<span class="k">SELECT</span> <span class="k">column_name</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">table2</span><span class="p">;</span>
</code></pre></div>
<p>Suppose we want to see if there are any categories that are in the <code>new_products</code> table that aren&rsquo;t in the <code>legacy_products</code> table. We can use an <code>EXCEPT</code> query to perform this analysis:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">new_products</span>
<span class="k">EXCEPT</span>
<span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">legacy_products</span><span class="p">;</span>
</code></pre></div>
<p>Conversely, select the items in the category column that are in the <code>legacy_products</code> table and not in the <code>new_products</code> table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">legacy_products</span>
<span class="k">EXCEPT</span>
<span class="k">SELECT</span> <span class="n">category</span> <span class="k">FROM</span> <span class="n">new_products</span><span class="p">;</span>
</code></pre></div>
<h3 id="what-can-we-generalize-so-far_1">What can we generalize so far?<a class="headerlink" href="#what-can-we-generalize-so-far_1" title="Permanent link">&para;</a></h3>
<ul>
<li>The <code>UNION</code> clause allows us to utilize information from multiple tables in our queries.</li>
<li>The <code>UNION ALL</code> clause allows us to utilize information from multiple tables in our queries, including duplicate values.</li>
<li><code>INTERSECT</code> is used to combine two <code>SELECT</code> statements, but returns rows only from the first <code>SELECT</code> statement that are identical to a row in the second <code>SELECT</code> statement.</li>
<li><code>EXCEPT</code> returns distinct rows from the first <code>SELECT</code> statement that aren’t output by the second <code>SELECT</code> statement</li>
</ul>
<h2 id="conditional-aggregates">Conditional Aggregates<a class="headerlink" href="#conditional-aggregates" title="Permanent link">&para;</a></h2>
<p>Aggregate functions compute a single result from a set of multiple input values. You can think of aggregate data as data collected from multiple rows at a time. In this lesson, we&rsquo;ll continue learning about aggregate functions by focusing on conditionals, sums, and combining aggregate functions.</p>
<p>Conditional Aggregates are aggregate functions that compute a result set based on a given set of conditions.</p>
<p>The count function is an aggregate function, since it aggregates data from multiple rows.</p>
<p>Count the number of rows in the <code>flights</code> table, representing the total number of <code>flights</code> contained in the table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">flights</span><span class="p">;</span>
</code></pre></div>
<p>While working with databases, it&rsquo;s common to have empty or unknown &ldquo;cells&rdquo; in data tables.</p>
<p>What do we do when we need to test whether a value is or is not null? We use the special keywords <code>IS NULL</code> or <code>IS NOT NULL</code> in the <code>WHERE</code> clause (<code>= NULL</code> does not work).</p>
<p>Count the number of rows from the <code>flights</code> table, where <code>arr_time</code> is not null and the destination is <code>'ATL'</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">arr_time</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">AND</span> <span class="n">destination</span> <span class="o">=</span> <span class="s1">&#39;ATL&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Almost every programming language has a way to represent &ldquo;if, then, else&rdquo;, or conditional logic. In SQL, we represent this logic with the <code>CASE</code> statement, as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span>
    <span class="k">CASE</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="k">THEN</span> <span class="s1">&#39;Low&#39;</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="k">BETWEEN</span> <span class="mi">500</span> <span class="k">AND</span> <span class="mi">1999</span> <span class="k">THEN</span> <span class="s1">&#39;Medium&#39;</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&gt;=</span> <span class="mi">2000</span> <span class="k">THEN</span> <span class="s1">&#39;High&#39;</span>
        <span class="k">ELSE</span> <span class="s1">&#39;Unknown&#39;</span>
    <span class="k">END</span> <span class="k">AS</span> <span class="n">elevation_tier</span><span class="p">,</span> 
    <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">airports</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>In the above statement, <code>END</code> is required to terminate the statement, but <code>ELSE</code> is optional. If <code>ELSE</code> is not included, the result will be <code>NULL</code>. Also notice the shorthand method of referencing columns to use in <code>GROUP BY</code>, so we don&rsquo;t have to rewrite the entire <code>CASE</code> Statement.</p>
<p>Modify the case statement&rsquo;s such that when the elevation is less than 250, the <code>elevation_tier</code> column returns <code>'Low'</code>, when between 250 and 1749 it returns <code>'Medium'</code>, and when greater than or equal to 1750 it returns <code>'High'</code>.</p>
<p>Be sure to alias the conditional statement as <code>elevation_tier</code>, in your query.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span>
    <span class="k">CASE</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&lt;</span> <span class="mi">250</span> <span class="k">THEN</span> <span class="s1">&#39;Low&#39;</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="k">BETWEEN</span> <span class="mi">250</span> <span class="k">AND</span> <span class="mi">1749</span> <span class="k">THEN</span> <span class="s1">&#39;Medium&#39;</span>
        <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&gt;=</span> <span class="mi">1750</span> <span class="k">THEN</span> <span class="s1">&#39;High&#39;</span>
        <span class="k">ELSE</span> <span class="s1">&#39;Unknown&#39;</span>
    <span class="k">END</span> <span class="k">AS</span> <span class="n">elevation_tier</span><span class="p">,</span> 
    <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">airports</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Sometimes you want to look at an entire result set, but want to implement conditions on certain aggregates.</p>
<p>For instance, maybe you want to identify the total amount of airports as well as the total amount of airports with high elevation in the same result set. We can accomplish this by putting a <code>CASE WHEN</code> statement in the aggregate.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">state</span><span class="p">,</span> 
    <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&gt;=</span> <span class="mi">2000</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">count_high_elevation_aiports</span> 
<span class="k">FROM</span> <span class="n">airports</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">state</span><span class="p">;</span>
</code></pre></div>
<p>Using the same pattern, write a query to count the number of low elevation airports by state where low elevation is defined as less than 1000 ft. Be sure to alias the counted airports as <code>count_low_elevation_airports</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">state</span><span class="p">,</span> 
    <span class="k">COUNT</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">ELSE</span> <span class="k">NULL</span> <span class="k">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">count_low_elevation_aiports</span> 
<span class="k">FROM</span> <span class="n">airports</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">state</span><span class="p">;</span>
</code></pre></div>
<p>We can do that same thing for other aggregates like <code>SUM()</code>. For instance, if we wanted to sum the total flight distance and compare that to the sum of flight distance from a particular airline (in this case, United Airlines) by origin airport, we could run the following query:<br />
<code>sum(distance)</code> for all carriers (<code>total_flight_distance</code>)<br />
<code>sum(distance)</code> for <code>'UA'</code> only (others are turned to 0) (<code>total_united_flight_distance</code>).</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">origin</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_flight_distance</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">carrier</span> <span class="o">=</span> <span class="s1">&#39;UA&#39;</span> <span class="k">THEN</span> <span class="n">distance</span> <span class="k">ELSE</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_united_flight_distance</span> 
<span class="k">FROM</span> <span class="n">flights</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">origin</span><span class="p">;</span>
</code></pre></div>
<p>Using the same pattern, find both the total flight distance as and flight distance by origin for Delta (<code>carrier = 'DL'</code>).</p>
<p>Alias the flight distance as <code>total_flight_distance</code> and the and flight distance by origin as <code>total_delta_flight_distance</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">origin</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_flight_distance</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">carrier</span> <span class="o">=</span> <span class="s1">&#39;DL&#39;</span> <span class="k">THEN</span> <span class="n">distance</span> <span class="k">ELSE</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_delta_flight_distance</span> 
<span class="k">FROM</span> <span class="n">flights</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">origin</span><span class="p">;</span>
</code></pre></div>
<p>Using the same pattern, find the percentage of <code>flights</code> from Delta by origin (<code>carrier = 'DL'</code>):</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">origin</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="o">*</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">carrier</span> <span class="o">=</span> <span class="s1">&#39;DL&#39;</span> <span class="k">THEN</span> <span class="n">distance</span> <span class="k">ELSE</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span><span class="o">/</span><span class="k">sum</span><span class="p">(</span><span class="n">distance</span><span class="p">))</span> <span class="k">as</span> <span class="n">percentage_flight_distance_from_delta</span> <span class="k">FROM</span> <span class="n">flights</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">origin</span><span class="p">;</span>
</code></pre></div>
<p>Find the percentage of high elevation airports (<code>elevation &gt;= 2000</code>) by state from the <code>airports</code> table. In the query, alias the percentage column as <code>percentage_high_elevation_airports</code>.<br />
<code>(sum of '1') / count(*)</code> and not <code>(count of '1') / count(*)</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">state</span><span class="p">,</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="k">sum</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">elevation</span> <span class="o">&gt;=</span> <span class="mi">2000</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">ELSE</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="o">/</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>  <span class="k">as</span> <span class="n">percentage_high_elevation_airports</span> <span class="k">FROM</span> <span class="n">airports</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">state</span><span class="p">;</span>
</code></pre></div>
<h3 id="what-can-we-generalize-so-far_2">What can we generalize so far?<a class="headerlink" href="#what-can-we-generalize-so-far_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Conditional Aggregates are aggregate functions the compute a result set based on a given set of conditions.</li>
<li><code>NULL</code> can be used to denote an empty field value</li>
<li><code>CASE</code> statements allow for custom classification of data</li>
<li><code>CASE</code> statements can be used inside aggregates (like <code>SUM()</code> and <code>COUNT()</code>) to provide filtered measures</li>
</ul>
<h2 id="date-number-and-string-functions">Date, Number, and String Functions<a class="headerlink" href="#date-number-and-string-functions" title="Permanent link">&para;</a></h2>
<p>Oftentimes, data in columns of tables is not in the exact format we need to complete our desired analysis. We may need to extract a date from a full timestamp, manipulate a number, or combine first and last name columns to create a full name.</p>
<p>In this lesson, we&rsquo;ll be learning about some of SQL&rsquo;s built-in functions for transforming dates, numbers and strings. We&rsquo;ll be using database of bakeries in this lesson.</p>
<p>It is important to note that date, number, and string functions are highly database dependent. Here, we focus on built-in functions in the SQLite database management system.</p>
<p>Select ten rows from the bakeries table:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">bakeries</span> <span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div>
<p>We&rsquo;ll begin with dates. Dates are often written in the following format</p>
<ol>
<li>Date: &ldquo;YYYY-MM-DD&rdquo;</li>
<li>Datetime or Timestamp: &ldquo;YYYY-MM-DD hh: mm:ss&rdquo;</li>
</ol>
<p>We can use SQL&rsquo;s date functions to transform data into a desired format. Since date functions can be database specific, verify the functions that exist on your relational database management system. For example, this statement:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">DATETIME</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Using the datetime function, select the date and time of all deliveries in the <code>baked_goods</code> table using the column <code>delivery_time</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">DATETIME</span><span class="p">(</span><span class="n">delivery_time</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Now let&rsquo;s assume that we have a column in our <code>baked_goods</code> table named <code>manufacture_time</code> in the format &ldquo;YYYY-MM-DD hh: mm:ss&rdquo;. We&rsquo;d like to know the number of baked_goods manufactured by day, and not by second. We can use the <code>DATE()</code> function to easily convert timestamps to dates and complete the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="nb">DATE</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">),</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">count_baked_goods</span>
<span class="k">FROM</span> <span class="n">baked_goods</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="nb">DATE</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">);</span>
</code></pre></div>
<p>Similarly, we can query the time with:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">TIME</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">),</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">count_baked_goods</span>
<span class="k">FROM</span> <span class="n">baked_goods</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">TIME</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">);</span>
</code></pre></div>
<p>Find the number of baked goods by date of delivery. Be sure to alias the total count of baked goods as <code>count_baked_goods</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="nb">DATE</span><span class="p">(</span><span class="n">delivery_time</span><span class="p">),</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">count_baked_goods</span> <span class="k">FROM</span> <span class="n">baked_goods</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="nb">DATE</span><span class="p">(</span><span class="n">delivery_time</span><span class="p">);</span>
</code></pre></div>
<p>Given a datepart and a column of date or timestamp data type, we can increment date or timestamp values by a specified interval. For example, in SQLite, the statement:</p>
<div class="highlight"><pre><span></span><code><span class="n">DATETIME</span><span class="p">(</span><span class="n">time1</span><span class="p">,</span> <span class="s1">&#39;+3 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;40 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;2 days&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Would return a time 3 hours, 20 minutes, and 2 days after time1.</p>
<p>Imagine that each dessert in our <code>baked_goods</code> table is inspected 2 hours, 30 minutes, and 1 day after the manufacture time. To derive the inspection date for each baked good, we can use the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">DATETIME</span><span class="p">(</span><span class="n">manufacture_time</span><span class="p">,</span> <span class="s1">&#39;+2 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;30 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;1 day&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inspection_time</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Each of the baked goods is packaged by Baker&rsquo;s Market exactly five hours, twenty minutes, and two days after the delivery (designated by delivery_time). Create a query returning all the packaging times for the goods in the <code>baked_goods</code> table. Be sure to alias the package time column as <code>package_time</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">DATETIME</span><span class="p">(</span><span class="n">delivery_time</span><span class="p">,</span> <span class="s1">&#39;+5 hours&#39;</span><span class="p">,</span> <span class="s1">&#39;20 minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;2 days&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">package_time</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Numeric functions can be used to transform numbers. Some common SQLite mathematical functions are included below that take numeric data types as inputs:</p>
<ul>
<li><code>SELECT (number1 + number2);</code>: returns the sum of two numbers. Similar, SQL can be used for subtraction, multiplication, and division.</li>
<li><code>SELECT CAST(number1 AS REAL) / number3;</code>: returns the result as a real number by casting one of the values as a real number, rather than an integer.</li>
<li><code>SELECT ROUND(number, precision);</code>: returns the numeric value rounded off to the next value specified.</li>
</ul>
<p>In our <code>baked_goods</code> table, we have information about cost designated by <code>ingredients_cost</code>. For accounting purposes, we&rsquo;d like to make sure that each ingredient cost is rounded to four decimal places rather than two, to account for currency fluctuations.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="n">ingredients_cost</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">rounded_cost</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Find the bakery&rsquo;s distance from the market rounded to two decimal places. Be sure to alias the column as <code>distance_from_market</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">distance_from_market</span>
<span class="k">FROM</span> <span class="n">bakeries</span><span class="p">;</span>
</code></pre></div>
<p>A couple more useful numeric SQL functions are included below: <code>MAX</code> and <code>MIN</code>. <code>MAX(n1,n2,n3,...)</code>: returns the greatest value in the set of the input numeric expressions <code>MIN(n1,n2,n3,...)</code>: returns the least value in the set of the input numeric expressions</p>
<p>In our <code>baked_goods table</code>, in addition to the numeric <code>ingredients_cost</code> we have information about the packaging cost located in the packaging_cost column. We can use the MAX function to determine the overall greatest value of cost for each item using the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">MAX</span><span class="p">(</span><span class="n">ingredients_cost</span><span class="p">,</span> <span class="n">packaging_cost</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>We also have information about cook time designated as cook_time and cool down time designated as <code>cool_down_time</code> in the <code>baked_goods</code> table. Find the greatest time value for each item in the table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">MAX</span><span class="p">(</span><span class="n">cook_time</span><span class="p">,</span> <span class="n">cool_down_time</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Find the least time value for each item in the table.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">cook_time</span><span class="p">,</span> <span class="n">cool_down_time</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>String manipulation can be useful to derive information from columns. We&rsquo;ll cover a couple of the common string functions here.</p>
<p>A common use case for string manipulation in SQL is concatenation of strings. In SQLite, this is written as:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">string1</span> <span class="o">||</span> <span class="s1">&#39; &#39;</span> <span class="o">||</span> <span class="n">string2</span><span class="p">;</span>
</code></pre></div>
<p>For example, the bakeries table contains both city and state columns. In order to create a route for these columns, we use the <code>||</code> function to concatenate them as in the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">city</span> <span class="o">||</span> <span class="s1">&#39; &#39;</span> <span class="o">||</span> <span class="k">state</span> <span class="k">as</span> <span class="k">location</span>
<span class="k">FROM</span> <span class="n">bakeries</span><span class="p">;</span>
</code></pre></div>
<p>String functions are again, very database specific, and it is best practice to consult documentation before proceeding. </p>
<p>Combine the <code>first_name</code> and <code>last_name</code> columns from the bakeries table as the full_name to identify the owners of the bakeries. Be sure to add a space between the names in the <code>full_name</code> as shown in the example.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">first_name</span> <span class="o">||</span> <span class="s1">&#39; &#39;</span> <span class="o">||</span> <span class="n">last_name</span> <span class="k">as</span> <span class="n">full_name</span> <span class="k">FROM</span> <span class="n">bakeries</span><span class="p">;</span>
</code></pre></div>
<p>Another useful string function in SQL is <code>REPLACE()</code>:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">REPLACE</span><span class="p">(</span><span class="n">string</span><span class="p">,</span><span class="n">from_string</span><span class="p">,</span><span class="n">to_string</span><span class="p">)</span>
</code></pre></div><br />
The function returns the string string with all occurrences of the string <code>from_string</code> replaced by the string to_string. For example in <code>baked_goods</code>, there is a column named ingredients. The ingredients strings are formatted with underscores, such as <code>baking_soda</code> and <code>vanilla_extract</code>. To make these values more readable, we might like to replace the underscores with spaces. We can do so by using the following query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">REPLACE</span><span class="p">(</span><span class="n">ingredients</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">item_ingredients</span>
<span class="k">from</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<p>Any time <code>enriched_flour</code> appears in the ingredients list, we’d like to replace it with just flour. Apply this transformation and also be sure to remove the underscore in <code>enriched_flour</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="k">REPLACE</span><span class="p">(</span><span class="n">ingredients</span><span class="p">,</span><span class="s1">&#39;enriched_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">item_ingredients</span>
<span class="k">FROM</span> <span class="n">baked_goods</span><span class="p">;</span>
</code></pre></div>
<h3 id="what-can-we-generalize-so-far_3">What can we generalize so far?<a class="headerlink" href="#what-can-we-generalize-so-far_3" title="Permanent link">&para;</a></h3>
<ul>
<li>Date Functions:<ul>
<li><code>DATETIME</code>; Returns the date and time of the column specified. This can be modified to return only the date or only the time.</li>
<li><code>DATETIME(time1, +X hours, Y minutes, Z days)</code>: Increments the specificed column by a given number of hours, minutes, or days.</li>
</ul>
</li>
<li>Numeric Functions:<ul>
<li><code>(number1 + number2);</code>: Returns the sum of two numbers, or other mathematical operations, accordingly.</li>
<li><code>CAST(number1 AS REAL) / number2;</code>: Returns the result as a real number by casting one of numeric inputs as a real number</li>
<li><code>ROUND(number, precision);</code>: Returns the numeric value rounded off to the next value specified.</li>
</ul>
</li>
<li>String Functions:<ul>
<li><code>'string1' || ' ' || 'string2';</code>: Concatenates string1 and string 2, with a space between.</li>
<li><code>REPLACE(string,from_string,to_string)</code>: Returns the string with all occurrences of the string <code>from_string</code> replaced by the string <code>to_string</code>.</li>
</ul>
</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../codecademy_sql_analyzing_business_metrics/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Codecademy, SQL, Analyzing Business Metrics" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Codecademy, SQL, Analyzing Business Metrics
            </div>
          </div>
        </a>
      
      
        
        <a href="../introduction_to_sql_joins/" class="md-footer__link md-footer__link--next" aria-label="Next: Introduction to SQL JOINs" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Introduction to SQL JOINs
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>